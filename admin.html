<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Workspace | CareerLift</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="css/admin.css">

    <script>
        (function() {
            const token = localStorage.getItem('token');
            const userStr = localStorage.getItem('user');
            if (!token || !userStr) { window.location.href = 'login.html'; return; }
            const user = JSON.parse(userStr);
            if (user.role !== 'admin') {
                window.location.href = 'index.html';
            }
        })();
    </script>
</head>
<body>

    <div class="admin-layout">
        
        <aside class="sidebar" id="adminSidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fa-solid fa-layer-group"></i> 
                    <div>Career<span>Lift</span><small>Admin</small></div>
                </div>
                <i class="fa-solid fa-xmark close-sidebar" onclick="toggleSidebar()"></i>
            </div>
            
            <ul class="menu">
                <li class="menu-label">Main Menu</li>
                <li class="active" onclick="showSection('dashboard'); toggleSidebar()">
                    <i class="fa-solid fa-users"></i> <span>User Management</span>
                </li>
                <li onclick="showSection('manage-courses'); toggleSidebar()">
                    <i class="fa-solid fa-layer-group"></i> <span>Manage Courses</span>
                </li>
                <li onclick="showSection('manage-enrollments'); toggleSidebar()">
                    <i class="fa-solid fa-graduation-cap"></i> <span>Enrollments</span>
                </li>
                
                <li class="menu-label">Actions</li>
                <li onclick="showSection('add-course'); toggleSidebar()">
                    <i class="fa-solid fa-plus-circle"></i> <span>Create Course</span>
                </li>
                <li onclick="window.location.href='index.html'">
                    <i class="fa-solid fa-arrow-up-right-from-square"></i> <span>Live Website</span>
                </li>
            </ul>

            <div class="sidebar-footer">
                <button onclick="logout()" class="logout-btn">
                    <i class="fa-solid fa-power-off"></i> Sign Out
                </button>
            </div>
        </aside>

        <main class="main-content">
            
            <header class="topbar">
                <button class="mobile-toggle" onclick="toggleSidebar()">
                    <i class="fa-solid fa-bars-staggered"></i>
                </button>
                <div class="page-title">
                    <h1>Dashboard Overview</h1>
                    <p>Manage your institute's data and content.</p>
                </div>
                <div class="admin-profile-pill">
                    <div class="status-dot"></div> Super Admin
                </div>
            </header>

            <div class="content-wrapper">

                <section id="dashboard" class="admin-section active">
                    <div class="section-header-row">
                        <h2>All Users</h2>
                        <button class="btn-icon"><i class="fa-solid fa-filter"></i></button>
                    </div>
                    <div class="glass-card table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>User Profile</th>
                                    <th>Email Address</th>
                                    <th>Role</th>
                                    <th>Contact</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody"></tbody>
                        </table>
                    </div>
                </section>

                <section id="add-course" class="admin-section">
                    <div class="form-container">
                        <h2><i class="fa-solid fa-pen-to-square"></i> Create New Course</h2>
                        <form id="addCourseForm" class="glass-form">
                            
                            <div class="form-group">
                                <label>Course Title</label>
                                <input type="text" id="cTitle" placeholder="e.g. Professional Caregiving Level 2" required>
                            </div>

                            <div class="form-row-2">
                                <div class="form-group">
                                    <label>Category</label>
                                    <div class="select-wrapper">
                                        <select id="cCategory">
                                            <option value="medical">Medical & Health</option>
                                            <option value="freelancing">Freelancing & IT</option>
                                            <option value="diploma">International Diploma</option>
                                            <option value="Programming">Programming</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Course Type</label>
                                    <div class="select-wrapper">
                                        <select id="cType" onchange="toggleCourseFields()">
                                            <option value="free">Free Course</option>
                                            <option value="paid">Paid Program</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Thumbnail Image (Google Drive / URL)</label>
                                <input type="text" id="cThumb" placeholder="https://..." required>
                            </div>

                            <div id="freeFields" class="dynamic-fields">
                                <div class="field-group-label">Free Course Materials</div>
                                <textarea id="cSyllabus" placeholder="What will they learn?" rows="3"></textarea>
                                <textarea id="cNote" placeholder="Important Class Notes" rows="3"></textarea>
                                <input type="text" id="cVideo" placeholder="YouTube/Drive Video Link">
                            </div>

                            <div id="paidFields" class="dynamic-fields" style="display:none;">
                                <div class="field-group-label">Premium Course Details</div>
                                <div class="form-row-2">
                                    <input type="text" id="cPrice" placeholder="Price (e.g. 15000 BDT)">
                                    <input type="text" id="cCode" placeholder="Secret Code (e.g. CL-2025)">
                                </div>
                                <textarea id="cOverview" placeholder="Detailed Overview" rows="4"></textarea>
                                <textarea id="cPaidNote" placeholder="Premium Notes / Instructions" rows="3"></textarea>

                                <div class="lectures-box">
                                    <label>Live Lectures Setup</label>
                                    <div id="lectureContainer">
                                        <div class="lecture-row">
                                            <input type="text" class="lec-title" placeholder="Lecture 1 Topic">
                                            <input type="text" class="lec-link" placeholder="Zoom/Meet Link">
                                        </div>
                                    </div>
                                    <button type="button" class="btn-dashed" onclick="addLectureField()">
                                        <i class="fa-solid fa-plus"></i> Add Another Lecture
                                    </button>
                                </div>
                            </div>

                            <button type="submit" class="btn-primary-large">
                                Publish Course <i class="fa-solid fa-rocket"></i>
                            </button>
                        </form>
                    </div>
                </section>

                <section id="manage-courses" class="admin-section">
                    <div class="section-header-row">
                        <h2>Course Library</h2>
                    </div>
                    <div id="adminCourseGrid" class="course-grid-admin">
                        </div>
                </section>

                <section id="manage-enrollments" class="admin-section">
                    <div class="section-header-row">
                        <h2>Enrollment Requests</h2>
                        <span class="badge-count">Recent</span>
                    </div>
                    <div class="glass-card table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Student Details</th>
                                    <th>Course Applied</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                    <th style="text-align: right;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="enrollmentTableBody"></tbody>
                        </table>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <div id="editUserModal" class="modal-overlay">
        <div class="modal-glass">
            <div class="modal-header">
                <h3>Edit User</h3>
                <i class="fa-solid fa-xmark" onclick="closeEditUserModal()"></i>
            </div>
            <form id="editUserForm">
                <input type="hidden" id="editUserId">
                <div class="input-group">
                    <i class="fa-regular fa-user"></i>
                    <input type="text" id="editUserName" placeholder="Full Name" required>
                </div>
                <div class="input-group">
                    <i class="fa-regular fa-envelope"></i>
                    <input type="email" id="editUserEmail" placeholder="Email" required>
                </div>
                <div class="input-group">
                    <i class="fa-solid fa-phone"></i>
                    <input type="text" id="editUserPhone" placeholder="Phone">
                </div>
                <div class="select-wrapper">
                    <select id="editUserRole">
                        <option value="student">Student</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn-modal-action">Save Changes</button>
            </form>
        </div>
    </div>

    <div id="userModal" class="modal-overlay">
        <div class="modal-glass modal-small">
            <div class="user-profile-view">
                <div class="avatar-circle"><i class="fa-solid fa-user"></i></div>
                <h3 id="mName">User Name</h3>
                <span id="mRole" class="role-pill">Student</span>
            </div>
            <div class="user-details-list">
                <div class="detail-row">
                    <span>Email</span> <strong id="mEmail">...</strong>
                </div>
                <div class="detail-row">
                    <span>Phone</span> <strong id="mPhone">...</strong>
                </div>
                <div class="detail-row">
                    <span>Joined</span> <strong id="mDate">...</strong>
                </div>
            </div>
            <button onclick="closeUserModal()" class="btn-modal-close">Close</button>
        </div>
    </div>

    <div id="editCourseModal" class="modal-overlay">
        <div class="modal-glass modal-large">
            <div class="modal-header">
                <h3>Edit Course Details</h3>
                <i class="fa-solid fa-xmark" onclick="closeEditModal()"></i>
            </div>
            <form id="editCourseForm">
                <input type="hidden" id="editId">
                <div class="form-row-2">
                    <input type="text" id="editTitle" placeholder="Course Title" required class="glass-input">
                    <select id="editCategory" class="glass-input">
                        <option value="medical">Medical</option>
                        <option value="freelancing">Freelancing</option>
                        <option value="diploma">Diploma</option>
                    </select>
                </div>
                <div class="form-row-2">
                    <input type="text" id="editPrice" placeholder="Price" class="glass-input">
                    <input type="text" id="editThumb" placeholder="Thumbnail URL" class="glass-input">
                </div>
                <textarea id="editOverview" placeholder="Description/Overview" rows="5" class="glass-input"></textarea>
                <button type="submit" class="btn-modal-action">Update Course</button>
            </form>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/admin.js"></script>
    <script>
        function toggleSidebar() {
            document.getElementById('adminSidebar').classList.toggle('active');
        }
    </script>
</body>
</html>